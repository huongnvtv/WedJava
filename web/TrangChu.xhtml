<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>Trang chủ</title>
    </h:head>
    <h:body>
        <ui:composition template="template/template.xhtml">
            <ui:define name="content" >
                <p:outputPanel id="opnMain" >
                    <p:outputPanel id="opnList" rendered="#{userController.displayMain()}" >
                        <p:commandButton value="Thêm mới" actionListener="#{userController.changStatusAdd()}" process="@this," update=":form_main:opnMain" />
                        <div style="float: right">
                            <div class="card" style="border: 1px solid skyblue ;background-color: skyblue" >
                                <!--  <h:form id="form_upload" enctype="multipart/form-data">
                                      <p:growl id="messageUpload" showDetail="true" /> -->
                                <p:fileUpload label="Upload file" value="#{userController.file}" mode="simple" skinSimple="true"/>
                                <p:commandButton value="Thêm bằng file" ajax="false" actionListener="#{userController.upload}" />
                                <!--  </h:form> -->
                            </div>
                        </div>
                        <div style="float: right">
                            <div class="card" >
                                <p:commandButton value="Download file excel Mẫu" global="false" immediate="true" process="@this" onclick="PrimeFaces.monitorDownload(start, stop)"
                                                 icon="pi pi-arrow-down" styleClass="ui-button-outlined" >
                                    <p:fileDownload value="#{userController.fileDowload}"/>
                                </p:commandButton>
                            </div>
                        </div>
                        <div style="float: right">
                            <div class="card" >
                                <p:commandButton value="Download file Log" global="false" immediate="true" process="@this" onclick="PrimeFaces.monitorDownload(start, stop)"
                                                 icon="pi pi-arrow-down" styleClass="ui-button-outlined" disabled="#{not userController.disableLog}" >
                                    <p:fileDownload value="#{userController.fileLog}"/>
                                </p:commandButton>
                            </div>
                        </div>
                        <p:panel header="Danh sách các USER" >
                            <p:dataTable value="#{userController.lstUser}" var="entity"
                                         reflow="true" styleClass="products-table" paginator="true" 
                                         rows="5" rowSelectMode="add" paginatorPosition="bottom" 
                                         >
                                <p:column headerText="Thao tác" >
                                    <p:commandLink styleClass="pi pi-pencil" title="Sửa" process="@this" update=":form_main:opnMain" actionListener="#{userController.changStatusEdit(entity)}"/>
                                    <p:commandLink styleClass="pi pi-copy" title="Copy" process="@this" update=":form_main:opnMain" actionListener="#{userController.changStatusCopy(entity)}"/>
                                    <p:commandLink styleClass="pi pi-eye" title="Xem" process="@this" update=":form_main:opnMain" actionListener="#{userController.changStatusView(entity)}"/>
                                    <p:commandLink styleClass="pi pi-trash" title="Xoá" process="@this" update="form_main:opnList :form_main:messages" actionListener="#{userController.handDelete(entity)}">
                                        <p:confirm header="Xác nhận xoá" message="Bạn có muốn xoá không" icon="pi pi-exclamation-triangle" />
                                    </p:commandLink>
                                </p:column>
                                <p:column headerText="Họ và tên" >
                                    <p:outputLabel value="#{entity.fullName}" />
                                </p:column>
                                <p:column headerText="Số điện thoại" >
                                    <p:outputLabel value="#{entity.telNumber}" />
                                </p:column>
                                 <p:column headerText="Trạng thái hoạt động" >
                                     <p:outputLabel value="đang hoạt động" rendered="#{entity.status eq '1'}" />
                                     <p:outputLabel value="không hoạt động" rendered="#{entity.status eq '0'}" />
                                </p:column>
                                <p:column headerText="Last time change password">
                                    <p:outputLabel value="#{loginController.converFormatDate(entity.lastTimeCHGPWD)}" />
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:outputPanel>
                    <p:outputPanel id="opnRegister" rendered="#{not userController.displayMain()}" >
                        <p:panel header="Thông tin chi tiết" >
                            <div class="row">
                                <div class="col-lg-2">
                                    <p:outputLabel value="Tên đăng nhập" for="username" />
                                </div>
                                <div class="col-lg-4">
                                    <p:inputText id="username" value="#{userController.user.userName}" 
                                                 required="true" requiredMessage="Nhập vào tên đăng nhập" disabled="#{userController.isView}"/>
                                </div>
                                <div class="col-lg-2">
                                    <p:outputLabel value="Họ và tên" for="fullname" />
                                </div>
                                <div class="col-lg-4">
                                    <p:inputText id="fullname" value="#{userController.user.fullName}" 
                                                 required="true" requiredMessage="Nhập vào họ và tên" disabled="#{userController.isView}" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-2">
                                    <p:outputLabel value="Mật khẩu" for="password" />
                                </div>
                                <div class="col-lg-4">
                                    <p:password id="password" value="#{userController.user.password}" 
                                                disabled="#{userController.isView}"/>
                                </div>
                                <div class="col-lg-2">
                                    <p:outputLabel value="Nhập lại mật khẩu" for="repassword" />
                                </div>
                                <div class="col-lg-4">
                                    <p:password id="repassword" value="#{userController.user.rePassword}" 
                                                disabled="#{userController.isView}" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-2">
                                    <p:outputLabel value="Số điện thoại" for="sdt" />
                                </div>
                                <div class="col-lg-4">
                                    <p:inputText id="sdt" value="#{userController.user.telNumber}" maxlength="10" disabled="#{userController.isView}" >
                                        <p:keyFilter regEx="/[\d]/"  preventPaste="false" />  
                                    </p:inputText>
                                </div>
                                <div class="col-lg-2">
                                    <p:outputLabel value="Email" for="email" />
                                </div>
                                <div class="col-lg-4">
                                    <p:inputText id="email" value="#{userController.user.email}" disabled="#{userController.isView}" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-4">
                                    <p:outputLabel value="Dải địa chỉ ip mong muốn(Nhập các ip cách nhau bởi dấu ';'" for="ip" />
                                </div>
                                <div class="col-lg-8">
                                    <p:inputText id="ip" value="#{userController.user.grantedIp}" disabled="#{userController.isView}" />
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-4">

                                </div>
                                <div class="col-lg-2">
                                    <p:commandButton value="Đồng ý" actionListener="#{userController.handOk()}" process="@this,form_main:opnRegister" update=":form_main:opnMain :form_main:messages" rendered="#{not userController.isView}" />
                                </div>
                                <div class="col-lg-2">
                                    <p:commandButton value="Quay lại" actionListener="#{userController.handCancel()}" process="@this," update=":form_main:opnMain" />
                                </div>
                            </div>
                        </p:panel>
                    </p:outputPanel>
                </p:outputPanel>
            </ui:define>
        </ui:composition>
    </h:body>
</html>

